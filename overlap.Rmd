
# The degree of overlap of words across sources

```{r setup_overlap, include=FALSE}


```


```{r intersect_sources, include=FALSE}
all_lists_ = list(Kilpatrick = all_lists %>% filter(source == 'kilpatrick') %>%  pull(word) %>% tolower() %>% unique(),
         Dolch = all_lists %>% filter(source == 'dolch') %>%  pull(word) %>% tolower() %>% unique(),
         Fry = all_lists %>% filter(source == 'fry') %>%  pull(word) %>% tolower() %>% unique(),
         Fundations = all_lists %>% filter(source == 'fundations') %>%  pull(word) %>% tolower() %>% unique(),
         Wonders = all_lists %>% filter(source == 'wonders') %>%  pull(word) %>% tolower() %>% unique())



intersect_words = wcbc %>% 
  filter(word %in% Reduce(intersect, all_lists_)) %>% 
  select(word, wcbc_rank) %>% 
  arrange(-desc(wcbc_rank)) %>% 
  mutate(final = str_c(word, ' (*', wcbc_rank, '*)')) %>% 
  select(final) %>% 
  pull(final)

intersect_words_ = c(intersect_words, c('', ''))

intersect_words_ = matrix(intersect_words_, nrow = 7, ncol = 5)

```

One way to compare the words that are included in various instructional sources, is by doing so directly: look at the words included in each source and examine the extent to which words are common across them. If there was a high degree of consensus about the sight word construct, then sources associated with the construct should share a set of common words across them (holding aside the issue of sources different quantities of words across sources). We see, however, that this is not the case. Across all five instructional sources included for analysis here, only ```r length(intersect_words)``` of all unique words are shared across all sources (```r round(length(intersect_words)/length(unique(all_lists$word))*100, digits = 1)```% of types). This set of words is shown in Table X.

\ Table X
```{r intersectTable, echo=FALSE, warning=FALSE, message=FALSE}
intersect_words_ %>% 
  apa_table(format = 'pandoc', caption = "Words Common across All Instructional Sources with Rank Frequency", note = "Words are arranged in descending frequency, and rank frequency is provided in parentheses and is calculated from Wisconsin Children's Book Corpus.", col.names = NULL)
```

This overlap can be seen visually in the diagram in Figure X. The very center of the figure represents those words that are common across all sources. Likewise, any overlapping portion of the diagram represents the overlap from the sources specified by that region, with the outer portions of the figure showing words unique to a specific source and no others. Kilpatrick represents the outlier source in this regard; it contains the most words (328) that are unique to a single source and no others. This set of words represents a high proportion of all words across all sources (34%).

```{r venn, echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.cap='A diagram depicting the overlap in words across sources. Raw counts are provided, with a percentage provided in parentheses showing the percentage of all unique words across all sources that a particular overlapping set represents. Sources can be identified by the outline color of the set. The figure was generated using the ggVennDiagram package in R (Gao, 2022).'}

COLORS_SOURCE2 = c('darkblue', 'darkred', 'darkorange', 'turquoise', 'red')
ggVennDiagram(all_lists_, label_size = 2, label_alpha = 0, set_size = 4) +
  scale_fill_gradient(low = 'white', high = 'firebrick') +
  scale_color_manual(values = COLORS_SOURCE2) +
  labs(fill = 'Count')
  

```

In order to characterize the overlap among sources at an interpretable level, we will focus on these two sets of words: those words shared by all sources and those shared by no sources. The common set of ```r length(intersect_words)``` words is composed of many of the highest frequency words in the set of all words across all sources. This is apparent by examining the frequencies from the Wisconsin Children's Book Corpus provided in Table X. Most of the words in this set are in the top 100 (rank frequency) of all words in WCBC, and all are in the top 500 (calculated over ```r nrow(wcbc)``` unique words in WCBC).

```{r symetricDifference, echo=FALSE, warning=FALSE, message=FALSE}

# This script determines the symmetrical difference of all words across all sources.

symmetrical_difference = list()

for (s in unique(all_lists$source)){
  
  o = all_lists %>% 
    mutate(word = tolower(word)) %>% 
    filter(source != s) %>% 
    distinct(word) %>% 
    pull(word)
  u = all_lists %>% 
    mutate(word = tolower(word)) %>% 
    filter(source == s) %>% 
    filter(word %nin% o) %>% 
    pull(word)
  
  symmetrical_difference[[s]] = u
}


symmetrical_difference_n = Reduce(sum, lapply(symmetrical_difference, length))
symmetrical_difference_words = unique(unlist(symmetrical_difference), use.names = FALSE)


```
